#!/bin/sh

# config
bookmarks_file="$HOME/dmenu/menus/listas/favoritos"
search_url="https://www.googile.com/search?q="
open_in_browser="abre_links.sh"

select_bookmark() {
    bookmarks=$(cat "$bookmarks_file")
    select=$(printf "%s\n" "$bookmarks" \
        | cut -d ';' -f1 \
        | dmenu -l 35 -c -z 200 -p "Firefox:" \
    )

    [ -z "$select" ] \
        && exit 0
    
    open=$(printf "%s" "$bookmarks)" \
        | grep -F "$select" \
        | cut -d ';' -f2 \
    )
    
    # select bookmark or search with duckduckgo
    [ -z "$open" ] \
        && open=$(printf "%s" "$search_url$select" \
            | sed 's/ /\%20/g' \
        )
}

# Abre favoritos
case "$1" in
    *)
        select_bookmark
        $open_in_browser "$open"
        ;;
esac
